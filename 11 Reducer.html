<!DOCTYPE html>
<html>
<head>
<title>11 Recucer.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="persistance-des-donn%C3%A9es-avec-redux">Persistance des données avec Redux</h1>
<h2 id="redux">Redux</h2>
<p><img src="ReduxArchitecture.png" alt="Redux"></p>
<ul>
<li>La View crée et envoie une action.</li>
<li>Cette action est récupérée par le store.</li>
<li>Le store modifie le state de votre application en fonction de l'action reçue.</li>
<li>La View détecte les changements du state global et se re-rend.</li>
</ul>
<h2 id="reducer">Reducer</h2>
<p>Un reducer est une fonction créée dans le store. Cette fonction a pour rôle de modifier le state de votre application en fonction d'une action reçue. Ce n'est donc pas le store qui modifie directement le state de votre application, mais un reducer contenu dans le store.</p>
<h2 id="objectif--g%C3%A9rer-les-favoris">Objectif : gérer les favoris</h2>
<p><img src="ReduxArchitecture2.png" alt="Redux"></p>
<ol>
<li>L'utilisateur clique sur le bouton pour ajouter le film aux favoris, une action est créée.</li>
<li>L'action est envoyée au store.</li>
<li>Le store possède un ou plusieurs reducers. Un des reducers sait comment gérer cette action, il fait signe au store de lui donner l'action et le state actuel de l'application.</li>
<li>Le reducer fait ce qu'il a à faire, il modifie le state de l'application en ajoutant le film aux favoris.</li>
<li>Le reducer redonne au store le state mis à jour avec le nouveau film favori.</li>
<li>Les components qui utilisent le state global de l'application sont informés qu'un changement a eu lieu et se re-rendent.</li>
</ol>
<h2 id="construction-dune-action">Construction d'une action</h2>
<p>Construction d'une action
Une action est, tout simplement, un objet avec deux paramètres :</p>
<ul>
<li>un paramètre type qui correspond au type d'action : ajout aux favoris, suppression des favoris, modification du profil, etc.</li>
<li>un paramètre value qui correspond à l'objet que l'on souhaite modifier dans le state : un film, le profil utilisateur, etc.</li>
<li>Pour gérer les actions, dans un reducer, on utilise un switch case</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">monReducer</span> (<span class="hljs-params">state, action</span>) </span>{
    <span class="hljs-keyword">let</span> nextState
    <span class="hljs-keyword">switch</span>(action.type) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">'ACTION_1'</span>:
            <span class="hljs-comment">// Modification du state de l'application</span>
            <span class="hljs-keyword">return</span> nextState
        <span class="hljs-keyword">case</span> <span class="hljs-string">'ACTION_2'</span>:
            <span class="hljs-comment">// Modification du state de l'application</span>
            <span class="hljs-keyword">return</span> nextState
        <span class="hljs-comment">//...</span>
        <span class="hljs-attr">default</span>: 
            <span class="hljs-keyword">return</span> state
    }
}
</div></code></pre>
<p><strong>Le state doit toujours rester immuable (cf. <a href="https://immutable-js.com/">documentation</a>).<br>
Pour modifier un objet immuable, il faut créer une copie de cet objet (donc créer un nouvel objet) et y appliquer vos modifications.</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment">//  Ici, on a créé un nouvel objet  nextState   dans lequel on a copié le state de l'application  ...state </span>
<span class="hljs-comment">// Respect du principe d'immuabilité</span>
<span class="hljs-keyword">let</span> nextState
nextState = {
    ...state,
    <span class="hljs-attr">profil</span>: action.value
}
</div></code></pre>
<pre class="hljs"><code><div><span class="hljs-comment">// Store/Reducers/favoriteReducer.js</span>
<span class="hljs-keyword">const</span> initialState = { <span class="hljs-attr">favoritesFilm</span>: [] }

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toggleFavorite</span>(<span class="hljs-params">state, action</span>) </span>{
  <span class="hljs-keyword">let</span> nextState
  <span class="hljs-keyword">switch</span> (action.type) {
     <span class="hljs-keyword">case</span> <span class="hljs-string">'TOGGLE_FAVORITE'</span>:
  <span class="hljs-keyword">default</span>:
    <span class="hljs-keyword">return</span> state
  }
}
</div></code></pre>
<p>Définir la fonction TOGGLE_FAVORITE pour ajouter ou supprimer un favori</p>
<pre class="hljs"><code><div><span class="hljs-comment">// Store/Reducers/favoriteReducer.js</span>

<span class="hljs-keyword">const</span> initialState = { <span class="hljs-attr">favoritesFilm</span>: [] }

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toggleFavorite</span>(<span class="hljs-params">state = initialState, action</span>) </span>{
  <span class="hljs-keyword">let</span> nextState
  <span class="hljs-keyword">switch</span> (action.type) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">'TOGGLE_FAVORITE'</span>:
      <span class="hljs-keyword">const</span> favoriteFilmIndex = state.favoritesFilm.findIndex(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.id === action.value.id)
      <span class="hljs-keyword">if</span> (favoriteFilmIndex !== <span class="hljs-number">-1</span>) {
        <span class="hljs-comment">// Le film est déjà dans les favoris, on le supprime de la liste</span>
        nextState = {
          ...state,
          <span class="hljs-attr">favoritesFilm</span>: state.favoritesFilm.filter( <span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> index !== favoriteFilmIndex)
        }
      }
      <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// Le film n'est pas dans les films favoris, on l'ajoute à la liste</span>
        nextState = {
          ...state,
          <span class="hljs-attr">favoritesFilm</span>: [...state.favoritesFilm, action.value]
        }
      }
      <span class="hljs-comment">// renvoie l'objet  nextState  si celui-ci n'est pas undefined, sinon on renvoie l'objet  state</span>
      <span class="hljs-keyword">return</span> nextState || state
  <span class="hljs-attr">default</span>:
    <span class="hljs-keyword">return</span> state
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> toggleFavorite
</div></code></pre>
<p>Création du Store</p>
<ul>
<li>On initialise le store en lui faisant passer notre reducer</li>
<li>
<ul>
<li>On peut avoir plusieurs reducers dans un store</li>
</ul>
</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-comment">// Store/configureStore.js</span>

<span class="hljs-keyword">import</span> { createStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'redux'</span>;
<span class="hljs-keyword">import</span> toggleFavorite <span class="hljs-keyword">from</span> <span class="hljs-string">'./Reducers/favoriteReducer'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> createStore(toggleFavorite)
</div></code></pre>
<p>Utilisation du Store via le Provider
Le Provider met le store à disposition dans toute l'application</p>
<pre class="hljs"><code><div>// App.js

import React from 'react'
import Navigation from './Navigation/Navigation'
import { Provider } from 'react-redux'
import Store from './Store/configureStore'

export default class App extends React.Component {
  render() {
    return (
      &lt;Provider store={Store}&gt;
        &lt;Navigation/&gt;
      &lt;/Provider&gt;
    )
  }
}
</div></code></pre>
<p>Maintenant il faut connecter le Component au Store</p>
<pre class="hljs"><code><div>// Components/FilmDetail.js

//...
import { connect } from 'react-redux'

//...

export default connect()(FilmDetail)
</div></code></pre>
<p>Voir la documentation <a href="https://react-redux.js.org/using-react-redux/connect-mapstate">mapStateToProps</a></p>
<p>Si on spécifie  mapStateToProps  dans la fonction  connect  , automatiquement, le component est abonné aux changements du store Redux.</p>
<pre class="hljs"><code><div>// Components/FilmDetail.js

//...

const mapStateToProps = (state) =&gt; {
  return {
    favoritesFilm: state.favoritesFilm
  }
}

export default connect(mapStateToProps)(FilmDetail)
</div></code></pre>
<p>À présent, dans les props du component FilmDetail, vous avez accès au state de l'application et donc aux films favoris. Vérifoez avec les logs :</p>
<pre class="hljs"><code><div><span class="hljs-comment">// Components/FilmDetail.js</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FilmDetail</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
    <span class="hljs-comment">//...</span>
    
    render() {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.props) <span class="hljs-comment">/* "favoritesFilm": Array [] */</span>
        <span class="hljs-keyword">return</span> (
            <span class="hljs-comment">//...    </span>
        )
    }
}
</div></code></pre>
<p>Lorsque vous allez ajouter un film aux favoris, le state de votre application va être mis à jour. Le store Redux va détecter ce changement et notifier tous les components connectés à votre store Redux, vous savez, tous les components que l'on a connectés grâce à la définition du paramètre  <code>mapStateToProps</code>.</p>
<pre class="hljs"><code><div>Components/FilmDetail.js

    _toggleFavorite() {
        // Action Redux
        const action = { type: &quot;TOGGLE_FAVORITE&quot;, value: this.state.film }
        // Envoi de l'action au Store Redux
        this.props.dispatch(action)
    }

    _displayFilm() {
        // ...
        &lt;Button title=&quot;Favoris&quot; onPress={() =&gt; this._toggleFavorite()}/&gt;
</div></code></pre>
<p>Vérification de l'événement <code>componentDidUpdate</code></p>
<pre class="hljs"><code><div>
  componentDidUpdate() {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"componentDidUpdate : "</span>)
    <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.props.favoritesFilm)
  }
</div></code></pre>
<p>FilmDetail.js complet</p>
<pre class="hljs"><code><div><span class="hljs-comment">// Components/FilmDetail.js</span>

<span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">import</span> { StyleSheet, View, Text, ActivityIndicator, ScrollView, Image, Button } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-native'</span>
<span class="hljs-keyword">import</span> { getFilmDetailFromApi, getImageFromApi } <span class="hljs-keyword">from</span> <span class="hljs-string">'../API/TMDBApi'</span>
<span class="hljs-keyword">import</span> moment <span class="hljs-keyword">from</span> <span class="hljs-string">'moment'</span>
<span class="hljs-keyword">import</span> numeral <span class="hljs-keyword">from</span> <span class="hljs-string">'numeral'</span>
<span class="hljs-keyword">import</span> { connect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-redux'</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FilmDetail</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  <span class="hljs-keyword">constructor</span>(props) {
    <span class="hljs-keyword">super</span>(props)
    <span class="hljs-keyword">this</span>.state = {
      <span class="hljs-attr">film</span>: <span class="hljs-literal">undefined</span>,
      <span class="hljs-attr">isLoading</span>: <span class="hljs-literal">true</span>
    }
  }

  componentDidMount() {
    getFilmDetailFromApi(<span class="hljs-keyword">this</span>.props.navigation.state.params.idFilm).then(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> {
      <span class="hljs-keyword">this</span>.setState({
        <span class="hljs-attr">film</span>: data,
        <span class="hljs-attr">isLoading</span>: <span class="hljs-literal">false</span>
      })
    })
  }

  componentDidUpdate() {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"componentDidUpdate : "</span>)
    <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.props.favoritesFilm)
  }

  _displayLoading() {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.state.isLoading) {
      <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.loading_container}</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">ActivityIndicator</span> <span class="hljs-attr">size</span>=<span class="hljs-string">'large'</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span></span>
      )
    }
  }

  _toggleFavorite() {
    <span class="hljs-keyword">const</span> action = { <span class="hljs-attr">type</span>: <span class="hljs-string">"TOGGLE_FAVORITE"</span>, <span class="hljs-attr">value</span>: <span class="hljs-keyword">this</span>.state.film }
    <span class="hljs-keyword">this</span>.props.dispatch(action)
  }

  _displayFilm() {
    <span class="hljs-keyword">const</span> { film } = <span class="hljs-keyword">this</span>.state
    <span class="hljs-keyword">if</span> (film != <span class="hljs-literal">undefined</span>) {
      <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ScrollView</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.scrollview_container}</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Image</span>
            <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.image}</span>
            <span class="hljs-attr">source</span>=<span class="hljs-string">{{uri:</span> <span class="hljs-attr">getImageFromApi</span>(<span class="hljs-attr">film.backdrop_path</span>)}}
          /&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.title_text}</span>&gt;</span>{film.title}<span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"Favoris"</span> <span class="hljs-attr">onPress</span>=<span class="hljs-string">{()</span> =&gt;</span> this._toggleFavorite()}/&gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.description_text}</span>&gt;</span>{film.overview}<span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.default_text}</span>&gt;</span>Sorti le {moment(new Date(film.release_date)).format('DD/MM/YYYY')}<span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.default_text}</span>&gt;</span>Note : {film.vote_average} / 10<span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.default_text}</span>&gt;</span>Nombre de votes : {film.vote_count}<span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.default_text}</span>&gt;</span>Budget : {numeral(film.budget).format('0,0[.]00 $')}<span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.default_text}</span>&gt;</span>Genre(s) : {film.genres.map(function(genre){
              return genre.name;
            }).join(" / ")}
          <span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.default_text}</span>&gt;</span>Companie(s) : {film.production_companies.map(function(company){
              return company.name;
            }).join(" / ")}
          <span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">ScrollView</span>&gt;</span></span>
      )
    }
  }

  render() {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.main_container}</span>&gt;</span>
        {this._displayLoading()}
        {this._displayFilm()}
      <span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span></span>
    )
  }
}

<span class="hljs-keyword">const</span> styles = StyleSheet.create({
  <span class="hljs-attr">main_container</span>: {
    <span class="hljs-attr">flex</span>: <span class="hljs-number">1</span>
  },
  <span class="hljs-attr">loading_container</span>: {
    <span class="hljs-attr">position</span>: <span class="hljs-string">'absolute'</span>,
    <span class="hljs-attr">left</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">right</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">top</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">bottom</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">alignItems</span>: <span class="hljs-string">'center'</span>,
    <span class="hljs-attr">justifyContent</span>: <span class="hljs-string">'center'</span>
  },
  <span class="hljs-attr">scrollview_container</span>: {
    <span class="hljs-attr">flex</span>: <span class="hljs-number">1</span>
  },
  <span class="hljs-attr">image</span>: {
    <span class="hljs-attr">height</span>: <span class="hljs-number">169</span>,
    <span class="hljs-attr">margin</span>: <span class="hljs-number">5</span>
  },
  <span class="hljs-attr">title_text</span>: {
    <span class="hljs-attr">fontWeight</span>: <span class="hljs-string">'bold'</span>,
    <span class="hljs-attr">fontSize</span>: <span class="hljs-number">35</span>,
    <span class="hljs-attr">flex</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">flexWrap</span>: <span class="hljs-string">'wrap'</span>,
    <span class="hljs-attr">marginLeft</span>: <span class="hljs-number">5</span>,
    <span class="hljs-attr">marginRight</span>: <span class="hljs-number">5</span>,
    <span class="hljs-attr">marginTop</span>: <span class="hljs-number">10</span>,
    <span class="hljs-attr">marginBottom</span>: <span class="hljs-number">10</span>,
    <span class="hljs-attr">color</span>: <span class="hljs-string">'#000000'</span>,
    <span class="hljs-attr">textAlign</span>: <span class="hljs-string">'center'</span>
  },
  <span class="hljs-attr">description_text</span>: {
    <span class="hljs-attr">fontStyle</span>: <span class="hljs-string">'italic'</span>,
    <span class="hljs-attr">color</span>: <span class="hljs-string">'#666666'</span>,
    <span class="hljs-attr">margin</span>: <span class="hljs-number">5</span>,
    <span class="hljs-attr">marginBottom</span>: <span class="hljs-number">15</span>
  },
  <span class="hljs-attr">default_text</span>: {
    <span class="hljs-attr">marginLeft</span>: <span class="hljs-number">5</span>,
    <span class="hljs-attr">marginRight</span>: <span class="hljs-number">5</span>,
    <span class="hljs-attr">marginTop</span>: <span class="hljs-number">5</span>,
  }
})

<span class="hljs-keyword">const</span> mapStateToProps = <span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">favoritesFilm</span>: state.favoritesFilm
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> connect(mapStateToProps)(FilmDetail)
</div></code></pre>
<p>Texte pour activer/décactiver les favoris : ♡ ♥
textFavori = '♡'
if (this.props.favoritesFilm.findIndex(item =&gt; item.id === this.state.film.id) !== -1) {
// Film dans nos favoris
textFavori = '♥'
}
return (
&lt;Button
style={styles.favorite_image}</p>
<pre><code>  /&gt;
)
</code></pre>
<p>favorite_container: {
alignItems: 'center', // Alignement des components enfants sur l'axe secondaire, X ici
}</p>
<pre class="hljs"><code><div>
Connecter le store Redux au component Search,&lt;br&gt;
ajouter la prop extraData sur la FlatList&lt;&gt;br&gt;
Une FlatList est un [PureComponent](https://reactjs.org/docs/react-api.html#reactpurecomponent)
Pour que la liste ce mettre à jour il faut utiliser l'attibut extraData
</div></code></pre>
<p>&lt;FlatList
data={this.state.films}
extraData={this.props.favoritesFilm}</p>
<pre><code>    &lt;FilmItem
          film={item}
        
          isFilmFavorite={(this.props.favoritesFilm.findIndex(film =&gt; film.id === item.id) !== -1) ? true : false}
          displayDetailForFilm={this._displayDetailForFilm}
        /&gt;
</code></pre>
<p>// On connecte le store Redux, ainsi que les films favoris du state de notre application, à notre component Search
const mapStateToProps = state =&gt; {
return {
favoritesFilm: state.favoritesFilm
}
}</p>
<p>export default connect(mapStateToProps)(Search)</p>
<pre class="hljs"><code><div>

</div></code></pre>

</body>
</html>
